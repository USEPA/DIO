---
title: "Build DIO Model"
output:
  md_document:
    variant: gfm
params:
    modelname: "DIOv2.0"
---


```{r setup, include=FALSE}

## Install useeior version with hybridization

#First check that devtools package is installed
if (!"devtools"%in%installed.packages()[, "Package"]) {
    install.packages("devtools")
}
library(devtools)

#devtools::install_github("USEPA/useeior@v1.1.0")

## Build the model using useeior
library(useeior)
# Identify the model specifications file for the selected DIO model
modelspec <- paste0(params$modelname, ".yml")
hybridspec <- "NGCombustion.yml"
configpaths <- file.path("data", c(modelspec,hybridspec))

DIO <- useeior::buildModel(params$modelname, configpaths)




```

## Validate Model

Validate that commodity output can be recalculated (within 1%) with the model total requirements matrix (L) and demand vector (y) for US production
```{r}
econval <- compareOutputandLeontiefXDemand(DIO, tolerance = 0.01)
print(paste("Number of sectors passing:",econval$N_Pass))
print(paste("Number of sectors failing:",econval$N_Fail))
print(paste("Sectors failing:", paste(econval$Failure$rownames, collapse = ", ")))
```



Write the model to Excel
```{r setup, include=FALSE}

useeior::writeModeltoXLSX(DIO,"../DIOv2.xlsx")
```